pipeline {
    agent { label 'docker1' }
 environment {
 report_file="${WORKSPACE}/report"
 COMPILER="${COMP_NAME}"
 USER=credentials('DOCKERHUB_USER')
 PASS=credentials('DOCKERHUB_PASSWORD')	
	}  
stages {
		stage(bash) {
		steps {
		sh '''
		if [ "$COMPILER" = "bash" ] | [ "$COMPILER" = "all" ]; then
		echo "creating dockerfile for bash code"
	        cd ${WORKSPACE}
	        echo "FROM ubuntu" > Dockerfile
	        echo "RUN mkdir /home/doron" >> Dockerfile
		echo "RUN cd /home/doron" >> Dockerfile
		echo "COPY ./scripts/bashfile.sh /home/doron" >> Dockerfile
	        echo "WORKDIR /home/doron" >> Dockerfile
	        echo "CMD bash /home/doron/bashfile.sh" >> Dockerfile
		echo "building bash docker image" 
		echo "building bash docker image" >> ${report_file}
		docker build -t bashimg:${BUILD_NUMBER} . 
		docker run bashimg:${BUILD_NUMBER} --entrypoint /bin/bash /home/doron/bashfile.sh doron
		fi'''         	
		}
	 	}
	}
        }
